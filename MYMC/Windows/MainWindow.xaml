<mah:MetroWindow x:Class="MYMC.Windows.MainWindow"
                 xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:mah="http://metro.mahapps.com/winfx/xaml/controls"
                 xmlns:behaviors="http://schemas.microsoft.com/xaml/behaviors"
                 xmlns:viewmodel="clr-namespace:MYMC.ViewModels"
                 xmlns:converters="clr-namespace:MYMC.Converters"
                 xmlns:iconpacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                 d:DataContext="{d:DesignInstance Type=viewmodel:MainViewModel}"
                 xmlns:wv2="clr-namespace:Microsoft.Web.WebView2.Wpf;assembly=Microsoft.Web.WebView2.Wpf"
                 Loaded="MainWindow_OnLoaded"
                 mc:Ignorable="d"
                 Title="MainWindow" Height="450" Width="800">
    <mah:MetroWindow.Resources>
        <converters:FractionConverter x:Key="FractionConverter" />
        <converters:PlaybackStateToIconConverter x:Key="PlaybackStateToIconConverter" />
    </mah:MetroWindow.Resources>
    <DockPanel LastChildFill="True">

        <StatusBar DockPanel.Dock="Bottom" x:Name="StatusBar">
            <StatusBarItem Content="{Binding StatusText}"
                           Width="{Binding ElementName=StatusBar, Path=ActualWidth, Converter={StaticResource FractionConverter}, ConverterParameter=0.2}"/>
            <Separator Foreground="{DynamicResource MahApps.Brushes.Badged.Foreground}" />
            <mah:MetroProgressBar IsIndeterminate="True"
                                  Foreground="{DynamicResource MahApps.Brushes.Badged.Foreground}"
                                  Height="15"
                                  Width="{Binding ElementName=StatusBar, Path=ActualWidth, Converter={StaticResource FractionConverter}, ConverterParameter=0.75}"
                                  Visibility="{Binding IsBusy, 
            Converter={StaticResource BooleanToVisibilityConverter}}" />
        </StatusBar>
        
        <Grid DockPanel.Dock="Bottom" Height="100">
            <StackPanel Orientation="Horizontal" Margin="8,0,0,0">
                <Button Style="{StaticResource MahApps.Styles.Button.Circle}"
                        Command="{Binding PreviousCommand}"
                        Width="36"
                        Height="36">
                    <iconpacks:PackIconMaterial HorizontalAlignment="Center" VerticalAlignment="Center"
                                                Kind="SkipPreviousOutline" />
                </Button>
                <Button Style="{StaticResource MahApps.Styles.Button.Circle}"
                        Command="{Binding TogglePlaybackCommand}"
                        Width="48" 
                        Height="48">
                    <iconpacks:PackIconMaterial HorizontalAlignment="Center" VerticalAlignment="Center">
                        <iconpacks:PackIconMaterial.Kind>
                            <MultiBinding Mode="OneWay" Converter="{StaticResource PlaybackStateToIconConverter}">
                                <Binding Path="IsBusy" />
                                <Binding Path="IsPlaying" />
                            </MultiBinding>
                        </iconpacks:PackIconMaterial.Kind>
                    </iconpacks:PackIconMaterial>
                </Button>
                <Button Style="{StaticResource MahApps.Styles.Button.Circle}"
                        Command="{Binding NextCommand}"
                        Width="36"
                        Height="36">
                    <iconpacks:PackIconMaterial HorizontalAlignment="Center" VerticalAlignment="Center"
                                                Kind="SkipNextOutline" />
                </Button>
                <Grid VerticalAlignment="Center" Margin="16,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"></RowDefinition>
                        <RowDefinition Height="Auto"></RowDefinition>
                    </Grid.RowDefinitions>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                        <ColumnDefinition Width="Auto"></ColumnDefinition>
                        <ColumnDefinition Width="*"></ColumnDefinition>
                    </Grid.ColumnDefinitions>
                    
                    <TextBlock Grid.Row="0" Grid.Column="0"
                               Grid.ColumnSpan="5"
                               Text="{Binding TrackInfo.Title, FallbackValue='Title'}"
                               VerticalAlignment="Center"
                               FontWeight="Bold"/>
                    <TextBlock Grid.Row="1" Grid.Column="0"
                               Text="{Binding TrackInfo.Artist, FallbackValue='Artist'}"
                               VerticalAlignment="Center"/>
                    <iconpacks:PackIconFontAwesome Grid.Row="1" Grid.Column="1" 
                                                   Kind="CircleSolid" VerticalAlignment="Center" Width="4" Margin="4, 0" />
                    <TextBlock Grid.Row="1" Grid.Column="2" 
                               Text="{Binding TrackInfo.Album, FallbackValue='Album'}"
                               VerticalAlignment="Center"/>
                    <iconpacks:PackIconFontAwesome Grid.Row="1" Grid.Column="3" 
                                                   Kind="CircleSolid" VerticalAlignment="Center" Width="4" Margin="4, 0" />
                    <TextBlock Grid.Row="1" Grid.Column="4" 
                               Text="{Binding TrackInfo.Year, FallbackValue='Year'}"
                               VerticalAlignment="Center"/>
                </Grid>
                
                
            </StackPanel>
        </Grid>

        <Grid DockPanel.Dock="Top">
            <wv2:WebView2 x:Name="WebView" NavigationCompleted="WebView_NavigationCompleted">
                <behaviors:Interaction.Triggers>
                    <behaviors:EventTrigger EventName="NavigationCompleted">
                        <behaviors:InvokeCommandAction Command="{Binding NavigationCompletedCommand}" />
                    </behaviors:EventTrigger>
                    <behaviors:EventTrigger EventName="NavigationStartingCommand">
                        <behaviors:InvokeCommandAction Command="{Binding NavigationStartingCommand}" />
                    </behaviors:EventTrigger>
                </behaviors:Interaction.Triggers>
            </wv2:WebView2>
        </Grid>
    </DockPanel>
</mah:MetroWindow>